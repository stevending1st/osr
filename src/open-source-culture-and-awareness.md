# 开源文化与认知

## 开源软件的定义和它的发展历程

### 开源软件的三大组成要素

* 开源软件的定义:开源软件是一种源代码免费向公众开放的软件，任何团体和个人都可以在其 License 的规定下对其进行使用、复制、传播及修改，并可以将该修改形成的软件的衍生版本再发布。（来源于 OSI 开源软件定义）
* 开源软件有六大特点：
  * 有特定的 License
  * 可获得源代码
  * 无许可费
  * 无任何担保
  * 可自由使用
  * 享有版权
* 开源软件三大组成要素：
  * License：License 就游戏规则，有严密组织监管遵守。
  * 社区模式：社区是组织方式，其发展的核心学问所在，主要特征：
  * 商业模式：很多并不是其独有的，主要包括：捐赠、技术服务、广告、增值产品、双重授权、软硬件结合等。
* 你应该知道的开源维权组织：
  * 开源促进委员会（Open Source Initiative，缩写：OSI），定义所有开源 License。
  * 自由软件基金会（Free Software Foundation，缩写：FSF），是业界最大的开源软件维权组织。
  * 软件自由的律师联盟（Software Freedom Law Center）。

### 开源推动着各领域发展

开源软件演变到今天，已经不是个人业余爱好，已成为了大公司角逐开放标准的战场。

  * 萌芽（1969-1990）：个人和大学（GNU/Linux）
  * 成型（1990-2005）：非盈利组织：基金会（Linux 基金会、Apache 基金会、Eclipse 基金会）
  * 快速发展（2005-至今）：大型 IT 企业，各行种业现代企业都参与到开源产业中，如 intel、IBM、Google等，也产出了很多开源项目，如 openstack、cloudfoundry 等，包括华为的 openEuler、Mindspore 等，这些项目创新引领技术和商业的前进。

## 开源不等于免费

### 开源≠免费

* 履行开源义务：开源软件使用者除了享有使用的权利，还必须按照 License 规定履行相应的开源义务，否则即违反了开源 License 。
  * 使用声明义务：在对外分发产品时，附上声明文档，注明产品所使用的开源软件名称、版权、License 内容等信息。
  * 代码开源义务：将一定范围内的代码对公众开放，开源范围视具体 License 的要求和产品具体使用方式而定。
* 经典案例：Cisco 产品因 GPL 传染的开源维权官司最终向 FSF 捐款 XXXX 万美金才解决。
  * Broadcom 在其 802.11 芯片中使用了 GPL 的 GUN/Linux 系统，Linksys WRT54G 无线路由器使用了 Broadcom 的芯片，2003Cisco 收购 Linksys 但未按照 GPL 规定将使用了该芯片的产品代码开源，FSF 提出维权，Cisco 陆续开放了 116 个型号路由器的源代码，但仍未达到 FSF 的要求，截至 2008 年，Cisco 依然拒绝开放所有相关源代码，FSF 与 Cisco 谈判破裂，同年 12 月 12 日，FSF 发起 licence 诉讼，Cisco 作出让步，根据 GPL 规定对开放的源码进行调整，2009 年 5 月 20 日，FSF 与 Cisco 达成和解，使用 FSF 软件的 Linksys 产品开放全部源代码。

### 开源 License 合规风险

#### 不同 License 约束内容的区别

以下 8 种 License 覆盖了开源软件中 90% 以上的代码，采用这些 License 的开源软件在业界应用也最为广泛；其中 GPL V2 对于开发者和二次开发者的义务要求最多，使用时应加以关注。

| 类别 | 许可证名称 | 典型项目 | 许可证注意事项 | 应用建议 |
| ----- | :---------: | :---------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------ |
| BSD类 | Apache V2.0 | ACE Tomcat                          | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，无开源义务。<br> 3. 软件所有人授予专利许可。 | 推荐使用！商业友好型许可证                             |
| BSD类 |     BSD     | FreeBSD                             | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，无开源义务。<br> 3. 无专利规定。 | 推荐使用！商业友好型许可证                             |
| BSD类 |     MIT     | ASN.1                               | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，无开源义务。<br> 3. 无专利规定。 | 推荐使用！商业友好型许可证                             |
| MPL类 |  CPL V1.0   | JUnit                               | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，但修改部分需要开源。<br> 3. 截取部分或全部开源代码与私有源代码混合将视为对原始软件的修改从而导致私有代码开源。<br> 4. 软件所有人授予专利许可。 | 可以使用！但关注修改后对应的开源义务                   |
| MPL类 |  MPL V1.0   | FireFox                             | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，但修改部分需要开源。<br> 3. 截取部分或全部开源代码与私有源代码混合将视为对原始软件的修改从而导致私有代码开源。<br> 4. 软件所有人授予专利许可 | 可以使用！但关注修改后对应的开源义务                   |
| MPL类 |  CDDL V1.0  | OpenSolaris                         | 1. 允许各种链接，无开源义务。<br> 2. 允许修改，但修改部分需要开源。<br> 3. 截取部分或全部开源代码与私有源代码混合将视为对原始软件的修改从而导致私有代码开源。<br> 4. 软件所有人授予专利许可 | 可以使用！但关注修改后对应的开源义务                   |
| GPL类 |   LGPL V2   | Jboss ml， OpenOffice， UcLibc，SDL | 1. 允许各种链接，动态链接无开源义务，静态链接需要开放与之链接私有软件的 .o 文件和 makefile。<br> 2. 允许修改再链接到私有软件，但是修改增加的功能实现不能依赖私有软件的数据或功能。<br> 3. 允许不受限制的使用头文件中的 numerical parameters（数值参数）， data structure layouts（数据结构布局） and accessors（存取）， or small macros（小宏）， inline functions（内联参数） and templates (ten or fewer lines in length)（十行以内的模板）<br> 4. 仅原则性声明专利应免费许可，无详细规定 | 慎重使用！只允许动态链接方式使用                       |
| GPL类 |   GPL V2    | Linux                               | 1. 允许各种链接，但被链接的整个产品需要开源。<br> 2. 允许修改，但被修改部分及整个产品均需要开源。<br> 3. 通过 pipes、sockets 和命令行参数与 GPL 软件进行通信，不会导致私有软件被传染。<br> 4. 仅原则性声明专利应免费许可，无详细规定。 | 慎重使用！由于可能导致产品整体负有开源义务，不建议使用 |

#### “宽松”型 License？担心有坑！

开源 License：所有开源软件都有其特定的 License，开源 License 在法律上赋予用户相关权利和义务，任何开源应用行为都必须围绕此“游戏规则”进行。
  * 权利：授予用户免费使用、修改、分发、商用等权利，包含版权授权，部分还有专利授权。
  * 义务：规定用户在应用开源过程中必须履行的义务，如做出特定声明，开放特定代码等。
* 案例：
  * Facebook 在 Github 上发布了一系列开源项目，其中如 React、Fresco 等，由于其先进的技术和宽松的 License（BSD）使得其项目广受用户欢迎。
  * Facebook 在其 BSD License 之外，还额外增加一份专利授权 License，将这些软件可能存在的 Facebook 专利授权给用户使用，但也正是这份专利 License，给这些软件的商业应用埋下了“地雷”，甚至 Apache 基金会甚至禁止 Facebook 的软件或代码进入 Apache 项目。
* 解析：
  * Facebook 这份专利授权 License 除了授予用户使用其专利的权利外，还增加了对 Facebook 的专利保护条款，即如果A公司使用了该软件，那么如果 Facebook 在其业务范围内与 A 公司有任何其他专利冲突，A 公司则不得向 Facebook 发起专利诉讼，导致 A 公司无法保护自身的专利。
* 启示：
  * 某些开源项目表面声明的 License 看似“宽松”，但可能潜藏风险，产品在引入开源软件时应获取其完整的 License。
  * 若无法确定 License 风险， 可先向法务部咨询，评估风险后再决定引入。

### 开源安全风险

#### 开源社区安全

* 业界主流社区从单点安全特性逐步向整体安全架构、供应链安全和安全基础设施等系统化建设方向发展。

  * Linux：项目诞生（1991）——支持 SELinux（2003）——Syzkaller Fuzz 关键（2016）——KSPP 安全项目（2017）——任命供应链（2020）——Sigstore 签名服务（2021）
  * ASOP：项目诞生（2008）——漏洞致谢（2009）——支持SEAndroid（2014）——原生支持 Fuzzing（2017）——奖励开源软件安全研究（2019）

  | 分类 | openEuler 等社区可借鉴点 |
  | ---------------------- | :---------------------------------------: |
  | 安全架构               |       单点安全技术——整体安全架构       |
  | 供应链安全             |       自身安全——上下游供应链安全        |
  | 安全基础设施（漏洞挖掘） |    单个漏洞奖励——漏洞挖掘等基础设施    |
  | 安全基础设施（安全开发） | 单一构建工具支持——安全开发基础设施支持 |

* 围绕开源件健康度和依赖度评估、漏洞感知与修复等系统化建设，是供应链安全发展的重点。

  * 开源软件存在的安全薄弱点：
    * 缺少安全 Metadata（缺乏文档、LICENSE、反馈渠道、维护状况等）
    * 未做到默认安全（使用不安全的加密算法、协议、设计等）
    * 软件依赖链不明确（较难获知依赖链的安全状况）
  * 开源软件漏洞风险：
    * 漏洞库信息缺乏（具体版本漏洞信息不准确）
    * 代码质量参差，存在漏洞风险（潜在漏洞数量多）
  * Google 安全实践：
    * 2020 年布局 OpenSSF 社区，构建开源社区安全能力量化评估体系
    * 2021 年发布 OSI（Open Source Insights），建立开源软件依赖链信息库
    * 2021 年发布 OSV（Open Source Vulnerabilities），建立开源软件漏洞信息库，支持开源版本漏洞查询
    * 发布 OSS-Fuzz 平台及 Patch 奖励项目，提供 Fuzz 算力和修复资源，增强开源软件漏洞挖掘力量

#### 网络安全：OpenSSL 心脏滴血事件影响之大！

业界 OpenSSL 心脏滴血事件：心脏滴血已经是过去式了吗？NO！事隔一年多之后，臭名昭著的心脏滴血安全漏洞并没有完全消失，仍然对 20 万的网络设备存在安全威胁。Shodan 创始人 John Matherly在 Twitter 上贴出了一张地图，上面列出了全球仍然受该安全问题影响的国家：57272 台设备位于美国；德国位居第二，有 21060 台；中国有 11300 台存在心脏滴血漏洞的设备；法国第四，10094 台；英国紧随其后，9125 台。

*  HeartBleed 漏洞概括：

   * 心脏滴血首次发现于 2014 年，当时引起了不少恐慌。该漏洞可以允许攻击者利用 OpenSSL 软件库中的安全漏洞窃取目标设备上的密码等敏感信息。
   * Heartbleed 漏洞是由于未能在 `memcpy()` 调用受害用户输入内容作为长度参数之前正确进行边界检查。攻击者可以追踪 OpenSSL 所分配的 64KB 缓存、将超出必要范围的字节信息复制到缓存当中再返回缓存内容，这样一来受害者的内存内容就会以每次64KB的速度进行泄露
*  大量设备未更新补丁，仍可被攻击：
   * 尽管许多网民在漏洞披露之后都纷纷更新软件以修复该漏洞，然而，一年多以后，或者是大意，或者是软件不太容易打补丁，有近20万的设备还在受该漏洞的威胁。
*  安全顾问 Graham Cluley 指出：
   * “很显然，有些制造商和IT团队并没有更新存在漏洞的系统。我敢打赌，肯定有些联网设备存在心脏滴血漏洞。” 
   * Matherly 指出管理员们可以利用 Shodan 搜索工具检查它们的联网设备是否仍然存在心脏滴血漏洞。除了更新 OpenSSL 之外，管理员们还可以采取更进一步的安全措施：更改密钥、转储会话 cookies。
*  教训：开源安全漏洞传播快，影响大，快速排查受影响的产品并进行修复是降低影响的关键。

#### 网络安全：Log4Shell 漏洞影响面之广！

* 案例：2021 年 11 月 24 日在 Web 服务器软件阿帕奇（Apache）下的开源日志组件 Log4j 2.x 内发现漏洞，这个后来编号为 CVE-2021-4428 的漏洞，花名为 Log4Shell。这一漏洞的存在，可以让网络攻击者无需密码就能访问网络服务器。网络安全管理公司 Cloudflare 首席安全官乔·沙利文（Joe Sullivan）表示，这一漏洞允许恶意攻击者“远程执行代码”，以获取对其他系统的访问，鉴于 Log4j 软件被广泛使用，这可能是迄今为止“最大的漏洞”。
* 启示：
  1. 识别产品中正在使用关键的开源项目;
  2. 大规模使用开源软件的公司对开源软件要谨慎选择、持续维护。

## 开源治理构建基础能力

### 开源治理方法论

#### 开源应用不当会导致的问题

| 主要因素 | 开源软件特点 | 会带来的问题 |
| -------- | :------------------------------------------------------: | :----------------------------------------------------------- |
| License | 部分开源软件 License 强调回馈社区 | 不遵守其 License 会被投诉甚至起诉，迄今相关纠纷超过百起，最严重的情况为侵权方被判停止销售侵权产品 |
| 安全 | 部分开源软件存在安全漏洞 | 开源软件安全漏洞相对透明，传播快，影响大 |
| 专利权 | 开源软件的合作开发模式需要处理好不同开发者的知识产权问题 | 开源软件领域知识产权纠纷的频频发生，如果将一些流行的私有软件代码公开，追溯知识产权的归属，也一定难逃诉讼 |
| 采购 | 开源软件应用十分广泛，外购软件也可能应用开源软件 | 产品外购软件可能存在违规使用开源软件的风险，采购时需加于关注 |
| 维护成本 | 活跃开源软件更新很快，且将代码放入主版本需要技巧 | 若自行修改了开源软件，就可能形成“私有开源代码”，需自行维护全部开源代码，成本极高 |
| 保障 | 社区不承诺技术支持职责 | 需有外部或者内部团队掌握相关关键技术及获取社区技术支持的技能，否则将面临缺乏技术支撑保障的风险 |

#### 使用开源最基本要求：安全可信、合法合规

* 管控内容
  * 来源可信：
    * 来源正规社区官网、供应商官网或厂家官网
    * 供应商或合作商提供
    * 软件有明确的许可证或签订有相关使用协议
  * 网络安全：
    * 选型与应用评估（网络安全）
    * 漏洞闭环管理（收集、分发、处理、预警）
    * 安全问题处理    
  * 合法合规：
    * 按许可要求使用，避免知识产权、License 带来法律风险
    * 获得供应商授权才能使用
    * 对于开源软件履行开源义务，避免导致产品开源或公司声誉受损  
  * 过程透明：
    * 所有使用开源软件 Item 化管理
    * 产品使用开源软件须先申请后使用
    * 变更受控，有修改记录可查
    * 通过 PDM 申请建立版本与开源软件及漏洞的关系，支撑漏洞 E2E 闭环  
  * 优选引入/生命周期：
    * 引入进行归一，建立优选库\路标库，减少种类和数量
    * 牵引使用优选软件，禁选软件禁止使用，保障使用质量和安全
    * 生命周期与产品版本匹配，有节奏升级演进

#### 来源可信：植入木马案例 

* 事件概述：非官方 Xcode 被植入恶意代码 
  2015 年 9 月份的事件，起初并未引起我们的注意，一开始大家只以为是个别开发者使用了非官方渠道下载的 xcode 导致开发的应用编译出来含有恶意代码，随后我们发现很多在 Appstore 中的应用都发现检测出了恶意代码，同时包含很多知名的应用：微信，网易，12306 等等，此时我们才知道这件事情绝非我们想象的那么简单，虽然恶意代码的行为并不是那么复杂，然而其传播方式却是非常罕见而独特，如同重重一击打破了我们对恶意代码传播方式的固化思维。
* 一句话点评：图灵奖得者 keen Thompson 一语成谶，看你还敢用网盘上共享的编译器！
* 教训：必须从官方渠道获取开源版本，使用前确保来源可靠

### 优选引入

引言：从企业需求层面来看，如何引入开源软件？引入哪一款开源软件？可以从以下几个方面来加以考虑：

* 需求满足度
* 开源许可证
* 技术先进性
* 软件成熟度
* 运维能力
* 商业支持
* 社区活跃度
* 响应时间
* 软件生态
* 社区贡献
* 服务内容
* 产品周期
* 交付方式
* 权益保障

#### 优选引入：以XML类软件选型为例

* 从官网获取软件版本基本信息
  * 注意：官网，不是代码托管网站（Maven/Pypi/Cargo等代码托管网站并不是官网）

| 软件名称         |                tinyxml2                 | libxml2                          | PugiXML                         | Xerces-C++                                             |
| ---------------- | :-------------------------------------: | :------------------------------- | ------------------------------- | ------------------------------------------------------ |
| 语言             |                   C++                   | C                                | C++                             | C++                                                    |
| 最新版本         |                  7.0.1                  | 2.9.9                            | v1.9                            | 3.2.2                                                  |
| 最新版本发布时间 |               2018/11/18                | 2019/1/4                         | 2018/4/4                        | 2018/3/14                                              |
| 官网             | http://leethomason.github.io/tinyxml2/  | http://xmlsoft.org/              | http://pugixml.org/             | http://xerces.apache.org/                              |
| Github/代码库    | https://github.com/leethomason/tinyxml2 | https://github.com/GNOME/libxml2 | https://github.com/zeux/pugixml | http://svn.apache.org/viewvc/xerces/c/?root=Apache-SVN |

* 分析开源软件 License

  * 注意：
    * 如果遇到 GPL 等高危 License，优先找商业友好 License 的替代软件
    * 对于多 License 软件，需要解包进行 License 分析

| 软件名称       |      tinyxml2       | libxml2                       | PugiXML     | Xerces-C++         |
| -------------- | :-----------------: | :---------------------------- | ----------- | ------------------ |
| License        | zlib/libpng License | MIT License 、libxml2 License | MIT License | Apache License 2.0 |
| 是否商业友好   |        符合         | 符合                          |             | 符合               |
| 是否有补充协议 |         无          | 无                            | 无          | 无                 |

* 从漏洞、补丁的可获得性分析软件网络安全特征

  * 注意：
    * 从 NVD 漏洞库查询软件版本历史漏洞信息，看备选版本是否有未修复的高危漏洞
    * 看官网是否给出漏洞披露渠道，对于漏洞披露渠道不明确的不建议引入
  * Libxml2 提供完整的 bug 及漏洞披露跟踪页面
  * TinyXML2 仍有未修复的漏洞
* 从软件活跃度看生命周期
  * 注意：
    * 衰退期软件：无新 LTS 版本，3 个 minor 历史发布周期内无新 minor 版本发布；代码几乎无增长，仅有少量开发者
    * 官网明确 EOS 的软件
    * 老旧软件：例如引入版本前已有较多更新版本发布
  * 衰退期：jcommon/jFreeChart （近3年无新版本，社区代码提交几乎为0）
  * 官网明确 EOS：Python2.7 分支（2020 年 1 月 1 日停止任何漏洞披露和维护）

### License 遵从

#### 开源使用声明义务

在对外分发产品时，附上声明文档，注明产品所使用的开源软件名称、版权、License 内容等信息。

* 开源使用声明内容：

  * 软件名称（版本）：如 Software: BusyBox 1.9.1
  * 软件版权信息：Copyright notice: Copyright© 1999-2004 busybox project. Copyright (c) 2001 David Schleef <ds@schleef.org>
  * License 名称：License: GPL v2.0
  * License 内容文本：This software XXXXXXXXXXXXXXXXXXXXXXXXX
* 开源使用声明内容：
  * 发布原则：随外发件（即产品向客户交付或分发的内容）分发， 且显而易见。必须遵守“易于获取”原则，即能够让用户较为容易地获取查看声明文档的全量内容，实际发布方式由产品根据自身情况确定。
  * 代码邀约文本：若产品涉及代码对外开源义务的履行（如使用了 GPL、LGPL 等具有对外开源义务的软件），必须在使用声明中附上代码邀约文本（Written offer）。
  * 软件版权信息：Copyright notice: Copyright© 1999-2004 busybox project. Copyright (c) 

#### 代码对外开源义务

常见License代码开源要求：

| 常见许可证类型 | 典型软件 | 触发代码开源义务前提条件 | 开源要求和范围 |
| -------------------------- | :-------------------: | :----------------------------------------------------------- | ------------------------------------------------------------ |
| BSD 类 如：Apache/BSD/MIT 等 |    Tomcat、OpenSSL     | 无                                                           | 无                                                           |
| MPL 类如：MPL/EPL 等         |    FireFox、Eclipse    | 1. 产品集成使用该软件，并对外分发或销售。<br/> 2. 产品对该软件进行了修改 | 1. 若无修改，则无需开源。<br/> 2. 若对其进行了修改，需将修改的部分开源**法务部最新结论：EPL 软件即使不修改，也需要对外开源**。 |
| LGPL                       |   Hibernate、glibc    | 产品集成使用该软件，并对外分发或销售                         | 1. 软件本身须开源。<br/> 2. 具有传染性，与其静态链接部分的代码也必须以 LGPL 许可开源；动态链接则不被传染。<br/> 3. 若对其进行修改，若修改后增加的功能实现依赖于产品软件的数据或功能，则产品代码也会被传染。 |
| GPL（GPLV2，GPLV3）        | Busybox、linux kernel | 产品集成使用该软件，并对外分发或销售                         | 1. 软件本身须开源。<br/> 2. 具有传染性，与其有链接关系的代码都必须以 GPL 许可对外开源，即与该软件在同一进程中运行的代码都必须开源。 |
| AGPL                       |      Berkeley_DB      | 产品集成使用该软件                                           | 在 GPL 上增加了一条限制：即便不对外分发，只要在网络服务器上使用 AGPL 软件提供网络服务，就需要履行相关开源义务。例如：Berkeley_DB，即使没有“分发”动作，通过 WEB 形式为用户提供服务，也要履行对外开源义务。 |

* 除了AGPL License，是否履行代码开源义务，与产品是否会对外分发强相关，若产品需对外分发，则必须履行开源义务，反之则无需履行。
* 部分产品中还集成了来自供应商的软件，若供应商软件中也使用了开源软件，产品应向供应商索取相应开源软件清单已经相关代码，以确保产品能够对下游用户履行代码义务。

#### 开源多License分析

* 文件 LICENSE.txt 明确 License 可二选一：如 SJCL
* 官网 LICENSE.txt 明确 License 唯一：如 cJson
* License 文件明确不同的文件夹使用不同的 License：如e2fsprogs，产品仅使用了 libdw 和 libelf，所以 License 是GPL 2.0。
* License 文件未明确 License，需要根据使用的文件进行判断使用了哪些 License。如 util-linux。

#### 开源使用声明义务案例

* 案例：2015 年，德国开源维权人 McHardy 向多家 Android 手机厂商发起开源维权，涉案企业包括三星、MOTO、中兴等，赔款金额达数百万欧元，维权理由之一就是以上厂商销售产品时没有正确履行使用声明义务。
* 解析：涉案的 Android 手机都使用了 iptable 软件，其License（GPL）明确要求分发者履行使用声明义务，但涉案手机的使用声明文档中并没有包含 iptable 的声明。
* 启示：
  * 几乎所有可商用的开源软件 License 都具有开源使用声明义务要求。
  * 涉及对外分发销售的产品中若使用了开源软件，必须在分发时使用声明文档中全量声明，不得缺失。

#### 代码对外开源义务案例

* **案例1**
2009 年，SFC 代理 busybox 社区起诉三星，百思买等 14 加公司，指控其生产的电视、DVD 播放器等产品违反了 GPL 协议，法院首次下达开源软件禁令，涉案产品被禁售
  * 解析：涉案产品都使用了 Busybox 软件，但企业并没有按照GPL 义务要求开放相应源代码，因此违反了 GPL v2 协议
  * 启示：
    * 几产品在引入开源软件时，应明确其是否有开源义务要求，评估产品履行能力后再使用，并在发布前做好开源准备。
    * 一旦发生开源维权诉讼，企业往往是弱势方，多为败诉/赔款和解收场，最严重可导致产品禁售。

* **案例2**
2016 年，著名开源维权人 Harald Welte 向我司索取某产品的开源代码，但该产品自身并未引入任何开源软件，经排查，发现该产品集成的某供应商软件中使用了 GPL 开源软件，产品经过一系列交涉，花费了大量时间和人力，才从供应商处获取到相应代码，提供给维权人。
  * 解析：若产品集成的供应商软件中包含了开源软件，产品作为再次分发方，也必须履行相应开源义务。
  * 启示：
    * 产品在引入供应商软件时，应按公司模板，在合同中明确开源义务履行保障条款（对于免费软件则推动供应商签署补充协议），确保供应商能够对我司履行开源义务。
    * 产品在发布前应向供应商索取开源软件清单与相应代码（若有强制开源义务），保证产品能够完整履行开源义务。

### 过程透明

#### 建立结构化开源软件 SwBOM 是解决来源可靠、可追溯和漏洞管理的基础

* 通过软件的 BOM（bill of material），也就是软件清单，包括我们一整套可追溯系统来实现，我们构建了一套缺陷跟踪系统来实现。
  * 跟踪一个软件或者开源组件里的一些漏洞，它还会把相应的是哪个产品使用了开源软件，哪些漏洞影响了这个产品，甚至于可以追踪到哪些客户感受到漏洞。整个链条上的所有元素都可以在这个追踪系统里展现出来。这样可以快速地帮助开发者及时地修复漏洞，识别出合规风险。
  * 帮助分析软件的嵌套，通过软件分析它有多少包，包与包之间的依赖关系，再通过这个包反推出它是一个什么样的软件。

#### 建立从开源漏洞发现到客户升级的漏洞 E2E 处理流程机制，确保漏洞及时被修复

* 通过漏洞追踪系统，包括舆情感知的一些系统来帮助我们发现漏洞。应急响应团在发现漏洞后，第一时间在满足 SLA 的情况下去修补相应的一个漏洞。修补漏洞，有相应的工作界面。（在安全培训具体讲解）。
* 在SLA的要求下修复完漏洞后，要和客户一起共同发布这个漏洞相应的处理方案和它影响的范围，帮助客户尽快地在现有的情况下解决相应的安全风险。

#### 企业如何修复开源软件漏洞

* 开源软件漏洞通过缺陷单跟踪处理，根据漏洞的风险等级，企业依据合同对漏洞修复的相应 SLA 要求进行修复。
  * 企业产品在研发阶段，基于对客户的承诺，划分漏洞风险等级，便于漏洞管理策略的制定。例如，某企业要求高风险开源软件漏洞（CVSS>=7）必须在产品版本发布前修复；中低风险漏洞（CVSS<7）经过实际风险评估后，可以遗留到下个补丁或版本修复，但是修复时间必须符合漏洞相应SLA要求。
  * 企业产品进入维护阶段后，所有开源软件漏洞都必须依据合同对漏洞修复的相应 SLA 要求进行修复。
  * 对于开源软件漏洞的修复，更倾向于跟随社区，与社区保持同步。

### 生命周期维护

#### 产品研发注意事项：避免“自维护成本陷阱”

* 自维护成本陷阱，是我们在使用开源软件，甚至于在开源软件相应的理解力大到一定程度之后，我们希望将开源软件中植入一些企业的竞争力，但植入企业竞争力必然会对开源软件拉分支，甚至于大量的修改。修改前期可能将开源软件的维护能力和功能特性，迅速拉升一个档次。久而久之，随着这个版本的不停地演进、发布，拉的分支越来越多，每个不同的分支都要进行相应的回复。

#### 案例分析

某公司要求：以社区披露漏洞的受影响版本为准，产品团队要分析开源软件新版本中存在的漏洞是否在维护的版本中也同时存在，如果存在，产品团队对所有选型引入的维护版本均须维护。

* 说明：产品团队需不断审视社区当前所有软件新版本中的漏洞是否在维护版本存在且受影响，同时产品团队启动对所有受漏洞影响的选型引入的维护版本的漏洞修补。
* 案例：产品团队 A 负责维护 OpenSSL 历史版本 1.1.1a/1.1.1b/1.1.1c 以及社区最新版本 OpenSSL 1.1.1d；产品团队从社区官网发现 OpenSSL 1.1.1d 版本存在漏洞 CVE-2019-1551，则产品团队通过官网或 NVD 披露的漏洞影响版本范围分析漏洞 CVE-2019-1551 是否也影响 OpenSSL 1.1.1a/1.1.1b/1.1.1c，如果也影响则需要将漏洞影响开源软件的版本刷新到漏洞库，并同时修补 OpenSSL 1.1.1a/1.1.1b/1.1.1c 版本的漏洞。
* 产品团队自行搭建构建环境，确保至少社区提供的一种构建方案能够编译通过。

### 开源软件生态

#### 什么是开源软件生态

* 基金会有两个重要的工作，第一点，中立协调。比如厂商与厂商之间是有竞争关系的，但是有基金会的中立场合，厂商之间可以针对某个问题进行讨论。第二点，基金会更多的赋予目标，能够去维护一个项目。因为以单一家公司，长期维护一个开源项目很难，基金会拿到钱，赞助开源项目。这个方式会产生很多新的问题。比如 Linux Foundation，支撑 Linux，逻辑上大家认为是可行的，但是在之后没有任何一个项目以这种方式成功的。
* 一个项目的成功，最核心的是产品的问题，也就是技术价值，第二是生态的问题，也就是商业生态的价值。整个循环起来，比如我们公司要投钱给基金会，基金会给这个人，让他往前去做。但这种商业模型是一个比较理想 的情况。
* 实际情况，有 2 种类型，一是金字塔型，比如红帽，红帽的模型是金字塔，红帽在金字塔尖，下游全是渠道，红帽做自己的社区，你可以参与进来，但反正红帽自己控制。一种是沙漏型，上游是开发者，开发者投入进来以后，下游审查。沙漏中间是窄的，中间代表产品，下漏漏出来的是 vender, vender 挣钱了，所以才会去上游继续投入开发者，这才有沙子的循环。我觉得沙漏模型才是一个真正好的开源社区，但要把中间控制住。比如技术路线，发展方案等。比如 openstack，就没有控制好，各个公司进去以后，把产品的边界打散了，不能形成一个正常的对产品的技术架构，包括愿景。

#### 开源软件商业模式

| 开源软件商业变现模式 | 说明 | 典型案例 |
| -------------------- | :---------------------------------------------------------- | :----------------------------------------------------------- |
| 企业版 | 开源版本免费，企业版获得许可和支持服务收入；通过开源向商业版引流 | MySQL、Docker、Cloudera |
| 高级功能收费 | 对面向规模使用的的可靠性、安全、管理等进阶功能和工具软件收费 | Redis，核心部分的组件是开源的，但工具类软件和进阶功能（如多租户，无共享分布式架构等）是收费的 |
| 订阅服务 | 开源许可证免除了开源社区对软件质量与缺陷修复的责任，由OSS厂商提供软件订阅服务 | Red Hat、Hortonworks |
| 开源软件集成服务 | 通过软件实施等技术服务收费 | SourceLabs 公司和 SpikeSource 公司，这些公司不主推自己的产品品牌，而是与多方开源软件厂商或社区合作 |
| 云服务 | 在公有云上提供基于开源软件的云服务；可通过开源向云服务引流 | MongoDB、Databricks、Elastic Search 等提供基于 Azure 和 AWS 上的云服务收费 |
| 通过硬件盈利 | 提供开源软件 + 硬件的一体化方案，通过硬件变现 | Intel/NVidia/AMD |
| SaaS服务 | 开源核心平台，对接更广泛的应用生态，通过 SaaS 服务变现 | Gitlab 提供开源代码托管服务，开源本身平台以对接更多应用；salesforce 等 |
| 应用和流量变现 | 通过开源促成应用，形成行业事实标准，并与应用生态形成绑定进行变现，如广告或 Marketplace 等 | Google 基于 Android 生态的广告收入每年超百亿美元 |

#### 微软，围绕 Azure，通过持续投资和并购，布局开源

* 加入开源专利联盟 OIN，同意向所有 OIN 成员开放其所有专利，包括 IDE Visual Studio Code、开源 JavaScript 扩展，.Net 开源核心类库,开源 Linux 环境 BashOnWindows 等。
* 面向开发者打通 2B 和 2C 的平台，通过什么周期管理的方式多路径做大开发者生态，建立完整渠道覆盖各级伙伴资源。
* 加大对开源厂商扶持力度，包括云上部署和提供销售变现通道。


#### 亚马逊：从开源业务收割者到新领域贡献者

* 最大化利用开源的价值来为自身业务创收
  * 大规模促进开源软件的云服务化（计费，监控，超卖等）
  * 补齐开源软件应用的最后一个公里（工具，文档，北向接口等）
* 新领域贡献者
  * Neo 作为 Apache 软件许可下的开源代码发布，支持广泛的框架和算法以及多样化的硬件架构。
  * AWS 通过开源打通自家 MXnet——Neo——Inferentia 软硬件全栈，通过软件适配硬件，云服务释放算力。应对来自 Google 和 NVIDIA 的竞争。




















​    











































